<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sober Day Tracker</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script> <!-- Include Chart.js -->
    <style>
        body {
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f4f4;
            text-align: center;
            display: flex;
            flex-direction: column;
            height: 100vh;
            overflow: auto; /* Allow scrolling */
        }

        /* Landing Page */
        .landing-page {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            flex: 1;
        }

        /* Header Section */
        .header {
            background-color: #7C4DFF; /* Example color */
            color: white;
            padding: 20px;
            position: relative;
        }

        .header h1 {
            font-size: 36px; /* Main Title */
            margin: 0;
        }

        .header h2 {
            font-size: 28px; /* Welcome Name */
            margin: 10px 0;
        }

        .header p {
            font-size: 16px; /* Start Date and Milestones Information */
            margin: 5px 0;
        }

        /* Input Form Styling */
        .input-form {
            margin: 20px;
        }

        .input-form input {
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
            border: 1px solid #ccc;
            width: 250px;
            font-size: 16px;
        }

        .input-form button {
            background-color: #4CAF50;
            color: white;
            border: none;
            padding: 10px;
            border-radius: 5px;
            cursor: pointer;
            width: 100%;
            font-size: 16px;
        }

        .input-form button:hover {
            background-color: #45a049;
        }

        /* Main Title */
        .main-title {
            font-size: 32px;
            margin: 20px 0;
            color: #333;
        }

        /* Recovery Duration Section */
        .recovery-duration {
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 20px 0;
        }

        .duration-card {
            background-color: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin: 0 10px;
            flex: 1;
        }

        .duration-card h2 {
            font-size: 24px;
            margin: 0;
        }

        /* Milestones Section */
        .milestones {
            margin: 20px;
            background-color: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .milestones h2 {
            font-size: 24px;
        }

        /* Fixed Navigation Bar */
        .nav-bar {
            display: flex;
            justify-content: space-around;
            background-color: #7C4DFF;
            padding: 10px 0;
            position: fixed; /* Fixed position */
            bottom: 0; /* Stick to the bottom */
            width: 100%;
            box-shadow: 0 -1px 5px rgba(0, 0, 0, 0.2); /* Add shadow for better visibility */
        }

        .nav-bar a {
            color: white;
            text-decoration: none;
            font-size: 16px;
        }

        /* Progress Bar Styles */
        .progress-container {
            margin: 20px;
            width: 90%; /* Full width */
            margin: auto; /* Center the progress bar */
        }

        .progress-bar {
            background-color: #E0E0E0; /* Grey for remaining */
            height: 20px; /* Height of the bar */
            border-radius: 10px; /* Rounded corners */
            position: relative; /* Position relative for text */
        }

        .progress {
            background-color: #4CAF50; /* Green for progress */
            height: 100%; /* Full height */
            border-radius: 10px; /* Rounded corners */
            width: 0; /* Start at 0% */
            transition: width 0.5s ease; /* Smooth transition */
        }

        /* Milestone Text */
        .milestone-text {
            position: absolute;
            top: -20px; /* Adjust position */
            font-size: 14px;
            color: #333;
            width: 100%;
            text-align: left; /* Align text to the left */
            padding-left: 5px; /* Slight padding */
        }

        .milestone-text-next {
            position: absolute;
            top: -20px; /* Adjust position */
            font-size: 14px;
            color: #333;
            width: 100%;
            text-align: right; /* Align text to the right */
            padding-right: 5px; /* Slight padding */
        }
    </style>
</head>
<body>

    <!-- Landing Page -->
    <div class="landing-page" id="landingPage">
        <h1>Sober Tracker</h1>
        <div class="input-form">
            <input type="text" id="userNameInput" placeholder="Enter your name" />
            <input type="date" id="sobrietyDateInput" placeholder="Sobriety Start Date" />
            <button onclick="saveUserData()">Start Tracking</button>
        </div>
    </div>

    <!-- Header Section -->
    <div class="header" id="header" style="display: none;">
        <h1 class="main-title">Sobriety Tracker</h1>
        <h2 id="userName">Welcome!</h2>
        <p id="sobrietyDate">Start Date: N/A</p>
        <p class="challenge" id="currentMilestone">Current Milestone: N/A</p>
        <p class="challenge" id="nextMilestone">Next Milestone: N/A</p>
    </div>

    <!-- Recovery Duration Section -->
    <div class="recovery-duration" id="recoveryDuration" style="display: none;">
        <div class="duration-card">
            <h2 id="years">0 Years</h2>
        </div>
        <div class="duration-card">
            <h2 id="months">0 Months</h2>
        </div>
        <div class="duration-card">
            <h2 id="days">0 Days</h2>
        </div>
    </div>

    <!-- Milestones Section -->
    <div class="milestones" id="milestones" style="display: none;">
        <h2>Next Milestone</h2>
        <div class="progress-container">
            <div class="progress-bar">
                <div class="progress" id="progressBar"></div>
                <div class="milestone-text" id="previousMilestoneText"></div>
                <div class="milestone-text-next" id="nextMilestoneText"></div>
            </div>
        </div>
        <p id="progressText">0% towards your next milestone</p>
        <p id="nextMilestoneDate"></p>
    </div>

    <!-- Fixed Navigation Bar -->
    <div class="nav-bar" id="navBar" style="display: none;">
        <a href="#" onclick="showUpdateForm()">Update Information</a>
        <a href="#">Help & Support</a>
    </div>

    <script>
        // Function to save user data
        function saveUserData() {
            const name = document.getElementById('userNameInput').value;
            const sobrietyDate = document.getElementById('sobrietyDateInput').value;

            if (name && sobrietyDate) {
                localStorage.setItem('userName', name);
                localStorage.setItem('sobrietyStartDate', sobrietyDate);
                updateUI(name, new Date(sobrietyDate));
            } else {
                alert("Please provide valid inputs.");
            }
        }

        // Function to update the UI with user's information
        function updateUI(name, sobrietyStartDate) {
            document.getElementById('landingPage').style.display = 'none';
            document.getElementById('header').style.display = 'block';
            document.getElementById('recoveryDuration').style.display = 'flex';
            document.getElementById('milestones').style.display = 'block';
            document.getElementById('navBar').style.display = 'flex';

            document.getElementById('userName').innerText = "Welcome " + name + "!";
            document.getElementById('sobrietyDate').innerText = "Start Date: " + sobrietyStartDate.toDateString();

            calculateSoberTime(sobrietyStartDate);
        }

        // Function to show the update form
        function showUpdateForm() {
            const storedName = localStorage.getItem('userName');
            const storedDate = localStorage.getItem('sobrietyStartDate');

            if (storedName && storedDate) {
                document.getElementById('userNameInput').value = storedName;
                document.getElementById('sobrietyDateInput').value = storedDate;
                document.getElementById('landingPage').style.display = 'flex'; // Show input form
                document.getElementById('header').style.display = 'none';
                document.getElementById('recoveryDuration').style.display = 'none';
                document.getElementById('milestones').style.display = 'none';
                document.getElementById('navBar').style.display = 'none';
            }
        }

        // Check if the user has already set their name and sobriety date
        window.onload = function() {
            const storedName = localStorage.getItem('userName');
            const storedDate = localStorage.getItem('sobrietyStartDate');

            if (storedName && storedDate) {
                updateUI(storedName, new Date(storedDate));
            }
        };

        // Function to calculate and display the sober time in years, months, and days
        function calculateSoberTime(sobrietyStartDate) {
            const today = new Date();
            let years = today.getFullYear() - sobrietyStartDate.getFullYear();
            let months = today.getMonth() - sobrietyStartDate.getMonth();
            let days = today.getDate() - sobrietyStartDate.getDate();

            // Adjust if days or months are negative
            if (days < 0) {
                months -= 1;
                const daysInLastMonth = new Date(today.getFullYear(), today.getMonth(), 0).getDate();
                days += daysInLastMonth;
            }

            if (months < 0) {
                years -= 1;
                months += 12;
            }

            // Update UI with the sober time
            document.getElementById('years').innerText = years + " Year" + (years !== 1 ? "s" : "");
            document.getElementById('months').innerText = months + " Month" + (months !== 1 ? "s" : "");
            document.getElementById('days').innerText = days + " Day" + (days !== 1 ? "s" : "");

            // Update milestones
            updateMilestones(years, months, days, sobrietyStartDate);
        }

        // Function to update milestones and progress
        function updateMilestones(years, months, days, sobrietyStartDate) {
            const totalDays = years * 365 + months * 30 + days; // Approximation for days
            let currentMilestone;
            let nextMilestone;
            let nextMilestoneDays;

            // Define milestone days
            if (totalDays < 1) {
                currentMilestone = "1 Day";
                nextMilestone = "1 Week";
                nextMilestoneDays = 7;
            } else if (totalDays < 7) {
                currentMilestone = "1 Week";
                nextMilestone = "1 Month";
                nextMilestoneDays = 30;
            } else if (totalDays < 30) {
                currentMilestone = "1 Month";
                nextMilestone = "6 Months";
                nextMilestoneDays = 183;
            } else if (totalDays < 183) {
                currentMilestone = "6 Months";
                nextMilestone = "1 Year";
                nextMilestoneDays = 365;
            } else if (totalDays < 365) {
                currentMilestone = "1 Year";
                nextMilestone = "2 Years";
                nextMilestoneDays = 730;
            } else if (totalDays < 730) {
                currentMilestone = "2 Years";
                nextMilestone = "5 Years";
                nextMilestoneDays = 1825;
            } else {
                currentMilestone = "5 Years";
                nextMilestone = "10 Years";
                nextMilestoneDays = 3650;
            }

            // Update UI with milestones
            document.getElementById('currentMilestone').innerText = "Current Milestone: " + currentMilestone;
            document.getElementById('nextMilestone').innerText = "Next Milestone: " + nextMilestone;

            // Calculate progress towards next milestone
            const progressPercent = Math.min((totalDays / nextMilestoneDays) * 100, 100); // Cap at 100%
            document.getElementById('progressText').innerText = Math.round(progressPercent) + "% towards your next milestone";

            // Calculate the expected date for the next milestone
            const nextMilestoneDate = new Date(sobrietyStartDate);
            nextMilestoneDate.setDate(nextMilestoneDate.getDate() + nextMilestoneDays);
            document.getElementById('nextMilestoneDate').innerText = "You will hit your next milestone on " + nextMilestoneDate.toLocaleDateString();

            // Update progress bar
            updateProgressBar(progressPercent, currentMilestone, nextMilestone);
        }

        // Function to update progress bar
        function updateProgressBar(progress, previousMilestone, nextMilestone) {
            const progressBar = document.getElementById('progressBar');
            progressBar.style.width = progress + "%"; // Set width based on progress

            // Set milestone texts
            document.getElementById('previousMilestoneText').innerText = previousMilestone;
            document.getElementById('nextMilestoneText').innerText = nextMilestone;
        }
    </script>

</body>
</html>
